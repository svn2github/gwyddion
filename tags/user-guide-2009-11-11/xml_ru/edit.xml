<?xml version="1.0" encoding="utf-8"?>
<!-- @(#) $Id: edit.xml 10405 2009-11-11 08:20:00Z yeti-dn $ -->
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<sect1 xmlns:xi="http://www.w3.org/2001/XInclude" id="editing-correction">
  <title id="editing-correction.title">Редактирование и коррекция данных</title>
  <indexterm><primary>коррекция дефектов</primary></indexterm>
  <para>Есть несколько модулей, которые позволяют прямо или косвенно редактировать данные СЗМ. В принципе, большая часть модулей обработки данных меняет их тем или иным образом. Однако, в этой секции мы хотели бы описать те модули и инструменты, которые специально предназначены для коррекции локальных дефектов изображения. Функции, представленные ниже, удаляют <quote>плохие</quote> данные из изображения и заполняют получившееся место результатом интерполяции.</para>
  <sect2 id="remove-spots">
    <title>Инструмент удаления пятен <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_spot_remove-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <para>Инструмент <quote><link linkend="remove-spots">удаление пятен</link></quote> может использоваться для удаления малых участков изображения. которые считаются ошибкой сканирования, пылинкой или ещё чем-то, что не должно присутствовать в данных. Следует заметить, что подобные действия могут кардинально поменять статистические параметры поверхности, следовательно, убедитесь, что вы не удаляете вещи, которые присутствуют на реальной поверхности.</para>
    <para>В процессе использования этого инструмента можно выбрать пятно, чтобы увеличить его окружение в окне инструмента. Затем, в этом окне, выберите прямоугольник вокруг области. которую вы хотите убрать. Можно выбрать один из нескольких методов интерполяции для создания данных на месте бывшего <quote>пятна</quote>:</para>
    <itemizedlist>
      <listitem>Выравнивание гиперболами - использует информацию с границ выбранной области для интерполяции информации внутри области.</listitem>
      <listitem>Псевдо-Лапласов и решение уравнения Лапласа - решает уравнение Лапласа для расчёта данных внутри области; граница используется как виртуальный источник.</listitem>
      <listitem>Фрактальная коррекция - используя полное изображение определяется фрактальная размерность. После этого создаются случайные неравномерные данные с той же фрактальной размерностью и помещаются в область.</listitem>
    </itemizedlist>
    <para>Нажатие на кнопку <guibutton>Применить</guibutton> выполнит выбранный алгоритм.</para>
    <para>
      <note>Удаление пятен работает только для областей размером 64 × 64 точки илименьше. Для удаления больших областей, создайте маску используя <link linkend="tool-mask-editor">редактор маски</link>, затем используйте <menuchoice><guimenu>Обработка данных</guimenu><guisubmenu>Исправить данные</guisubmenu><guimenuitem><link linkend="remove-data-under-mask">Удалить данные под маской</link></guimenuitem></menuchoice>.</note>
    </para>
  </sect2>
  <sect2 id="remove-grains">
    <title>Инструмент удаления зёрен <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_grains_remove-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <para>Этот простой инструмент удаляет выбранные вручную связные части маски или интерполирует данные под ними, или совершает оба этих действия. Часть маски, которую нужно удалить, выбирается щелчком по ней левой кнопки мыши.</para>
  </sect2>
  <sect2 id="remove-scars">
    <title>Удалить царапины <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_scars-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <indexterm><primary>коррекция царапин</primary></indexterm>
    <indexterm><primary>коррекция штрихов</primary></indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Удалить царапины</guimenuitem>
      </menuchoice>
    </para>
    <para>Царапины (полосы, штрихи) - части изображения, повреждённые очень распространённой ошибкой сканирования: локальным сбоем петли обратной связи. Линейные дефекты обычно параллельны оси быстрого сканирования изображения. Эта функция автоматически находит и удаляет эти царапины. используя соседние линии чтобы <quote>заполнить</quote> пустоты. Метод запускается с настройками, установленными при последнем использовании функции <quote><link linkend="mark-scars">пометить царапины</link></quote>.</para>
  </sect2>
  <sect2 id="mark-scars">
    <title>Пометить царапины</title>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Пометить царапины</guimenuitem>
      </menuchoice>
    </para>
    <para>Подобным образом, модуль <classname>Пометить царапины</classname> может создавать маску точек, рассматриваемых как царапины. В отличие от модуля<link linkend="remove-scars">Удалить царапины</link>, который напрямую интерполирует обнаруженные дефекты, этот модуль позволяет интерактивно задавать несколько параметров для тонкой настройки процесса выделения царапин:</para>
    <itemizedlist>
      <listitem>Максимальная ширина – только те царапины, толщина которых равна или меньше заданного значения (в пикселях), будут помечены.</listitem>
      <listitem>Минимальная длина – только царапины, которые равны или длиннее заданной величины (в пикселях) будут помечены.</listitem>
      <listitem>Жёсткий порог – минимальная разница значений относительно соседних верхней и нижней линии, которая будет считаться дефектом. Единицы считаются относительно среднеквадратичного отклонения изображения.</listitem>
      <listitem>Мягкий порог – значения, отличающиеся не меньше, чем на заданную величину не образуют дефектов сами, но присоединяются к дефектам полученным по жёсткому порогу если они граничат с ними.</listitem>
      <listitem>Положительные, Отрицательные, Оба – типы дефектов, которые будут удалены. Положительные означают дефекты с выпадающими значениями выше нормальных (пики), отрицательные – дефекты с выпадающими значениями ниже нормальных (дыры).</listitem>
    </itemizedlist>
    <para>После нажатия на кнопку <guibutton>Ok</guibutton> новая маска царапин будет наложена на изображение. Другие модули и инструменты могут затем применяться для редактирования этих данных.</para>
    <informalfigure id="fig-scars">
      <mediaobject>
        <imageobject>
          <imagedata fileref="remove-scars.png" format="PNG"/>
        </imageobject>
        <textobject>
          <phrase>Пример удаления царапин</phrase>
        </textobject>
        <caption>Пример выделения и удаления царапин: (a) исходные данные с дефектами, (b) данные с помеченными дефектами, (c) исправленные данные.</caption>
      </mediaobject>
    </informalfigure>
  </sect2>
  <sect2 id="remove-data-under-mask">
    <indexterm>
      <primary>интерполяция</primary>
      <secondary>данных под маской</secondary>
    </indexterm>
    <title>Удалить данные под маской <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_remove_under_mask-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Удалить данные под маской</guimenuitem>
      </menuchoice>
    </para>
    <para>Эта функция заменяет данные под маской на решение уравнения Лапласа. Значения данных на границе области под маской задают граничные условия. Решение вычисляется итерационно и на схождение может потребоваться какое-то время.</para>
  </sect2>
  <sect2 id="fractal-correction">
    <title>Фрактальная коррекция</title>
    <indexterm><primary>фрактальная интерполяция</primary></indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Фрактальная коррекция</guimenuitem>
      </menuchoice>
    </para>
    <para>Модуль фрактальной коррекции, подобно модулю <link linkend="remove-data-under-mask">Удалить данные под маской</link>, заменяет данные под маской. Однако, он использует другой алгоритм для получения новых данных: сперва рассчитывается фрактальная размерность полного изображения и затем области под маской заменяются случайной шероховатой поверхностью, имеющей ту же фрактальную размерность. Среднеквадратичное значение неровностей высоты (шероховатость) не меняется при использовании этого модуля.</para>
    <note>Расчёт может занять некоторое время, поэтому запаситесь терпением.</note>
    <warning>Применение этого модуля для данных, которые не обладают фрактальными свойствами может вызывать сильно нереалистичные результаты и строго не рекомендуется.</warning>
  </sect2>
  <sect2 id="mask-of-outliers">
    <title>Маска выпадающего</title>
    <indexterm><primary>коррекция выпадающего</primary></indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Маска выпадающего</guimenuitem>
      </menuchoice>
    </para>
    <para>Этот модуль создаёт маску областей данных, которые не соответствуют критерию <inlineequation><mathphrase>3σ</mathphrase><alt>3\sigma</alt></inlineequation>. Все данные выше и ниже доверительного интервала помечаются маской и могут впоследствии редактироваться или обрабатываться другими модулями.</para>
  </sect2>
  <sect2 id="line-correction">
    <title>Линейная коррекция <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_line_level-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <indexterm><primary>линейная коррекция</primary></indexterm>
    <para>Профили, взятые вдоль оси быстрого сканирования (обычно ось <inlineequation><mathphrase><phrase role="mathvar">x</phrase></mathphrase><alt>x</alt></inlineequation>), могут быть взаимно сдвинуты на некоторое значение или иметь несколько иной уклон. Основные функции линейной коррекции исправляют это несоответствие. Можно использовать несколько функций: инструменты <link linkend="line-polynomial">Полиномиальная</link> и <link linkend="path-level">Выравнивание доль линии</link> и некоторые процедуры из меню  <menuchoice><guimenu>Обработка данных</guimenu><guisubmenu>Исправить данные</guisubmenu></menuchoice>.</para>
    <para id="line-polynomial">Инструмент <quote>полиномиальная</quote></para>
    <para>Функции коррекции линий в меню <guisubmenu>Исправить данные</guisubmenu> производят коррекцию только горизонтальных линий, следовательно требуется поворот изображения для исправления столбцов. Они включают в себя:</para>
    <itemizedlist>
      <listitem><guimenuitem>Линейная коррекция подбором</guimenuitem>,</listitem>
      <listitem><guimenuitem>Линейная коррекция по медиане</guimenuitem>,</listitem>
      <listitem><guimenuitem>Линейная коррекция по моде</guimenuitem>,</listitem>
      <listitem><guimenuitem>Линейная коррекция по срединному разности</guimenuitem>,</listitem>
      <listitem><guimenuitem>Линейная коррекция ступенек</guimenuitem>.</listitem>
    </itemizedlist>
    <para>Первые три весьма похожи, все они выравниваю строки некоторого поля данных таким образом, чтобы минимизировать некоторую величину. Как показывают их имена, <guimenuitem>Линейная коррекция по медиане</guimenuitem> выравнивает медианы, в то время, как <guimenuitem>Линейная коррекция по моде</guimenuitem> пытается выровнять (псевдо)моды. <guimenuitem>Линейная коррекция подбором</guimenuitem> минимизирует некоторую функцию разницы линий, которая присваивает больший вес плоским участкам и меньший областям с большими наклонами. Результат всех трёх функций нередко весьма похож, хотя для некоторых типов данных одна из них может подходить лучше других.</para>
    <para>Функция <guimenuitem>Линейная коррекция по срединному разности</guimenuitem> сдвигает линии таким образом, что срединное значение разницы (между соседними по вертикали точками) становилось равным нулю вместо разницы срединных. Следовательно, она лучше сохраняет крупные детали, в то же время она более чувствительна к линиям, полностью заполненным мусором.</para>
    <para>Функция <guimenuitem>Линейная коррекция ступенек</guimenuitem> отличается от них. Она пытается определить смещённые сегменты в строках и исправить высоту каждого подобного сегмента индивидуально. Вследствие этого, она нередко может исправить данные с разрывом в середине строки. Эта функция носит характер экспериментальной и точный алгоритм её работы может меняться в дальнейшем.</para>
  </sect2>
  <sect2 id="path-level">
    <title>Выровнять вдоль линии <guiicon><inlinemediaobject><imageobject><imagedata fileref="gwy_path_level-24.png" format="PNG"/></imageobject></inlinemediaobject></guiicon></title>
    <indexterm><primary>выравнивание линии</primary></indexterm>
    <indexterm>
      <primary>выравнивание</primary>
      <secondary>вдоль линии</secondary>
    </indexterm>
    <para>Инструмент <guilabel>Выровнять вдоль линии</guilabel> может использоваться для коррекции высот в выбранном подмножестве линий на сложных изображениях.</para>
    <para>Вначале необходимо выбрать несколько прямых линий на данных. Пересечения этих линий со строками затем формируют набор точек в каждой строке, которые будут использованы для выравнивания. Строки двигаются вверх и вниз с целью минимизации разницы высоты точек в граничащих строках. Строки, которые не пересекаются ни одной линий не двигаются (относительно соседних строк).</para>
    <informalfigure id="fig-path-level">
      <mediaobject>
        <imageobject>
          <imagedata fileref="path-level.png" format="PNG"/>
        </imageobject>
        <caption>Пример выравнивания вдоль линии: (a) исходные данные со ступенями, которые автоматические линии могут исправить с ошибками, две подходящих выравнивающих линии выбраны; (b) результат применения выравнивания вдоль линии с шириной линии 5.</caption>
      </mediaobject>
    </informalfigure>
  </sect2>
  <xi:include href="unrotate.xml"/>
</sect1>
<!-- vim: set ts=2 sw=2 et : -->
