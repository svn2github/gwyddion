<?xml version="1.0" encoding="utf-8"?>
<!-- @(#) $Id: edit-extended.xml 10318 2009-10-29 13:57:58Z yeti-dn $ -->
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<sect1 id="edit-extended">
  <title>Расширенное редактирование данных</title>
  <para>Этот раздел представляет модули, разработанные для расширенного редактирования (коррекции) данных СЗМ. Используя простые инструменты редактирования данных, представленные в разделе <link linkend="editing-correction" endterm="editing-correction.title"/>, возможна коррекция многих локальных дефектов сканирования, которые могут появляться на данных СЗМ. Но в то же время при использовании методов СЗМ есть много источников ошибок которые ведут к глобальным ошибкам, такие как модуляция данных с низкой частотой или дрейф данных в медленной оси сканирования.</para>
  <sect2 id="drift-compensation">
    <title>Компенсация дрейфа</title>
    <indexterm><primary>компенсация дрейфа</primary></indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Компенсировать дрейф</guimenuitem>
      </menuchoice>
    </para>
    <para>Функция <quote>компенсировать дрейф</quote> рассчитывает и/или корректирует дрейф в быстрой оси сканирования (горизонтальной). Этот неблагоприятный эффект может быть вызван тепловым воздействием или недостаточной механической жесткостью устройства измерения.</para>
    <para>График дрейфа, который является одним из возможных результатов вывода, представляет горизонтальный сдвиг отдельных строк по отношению к строке-эталону (который может быть, в принципе, выбран произвольно, на практике выбирают нулевой сдвиг чтобы минимизировать количество данных, которые теряются за краем изображения после компенсации), с координатой <inlineequation><mathphrase><phrase role="mathvar">y</phrase></mathphrase><alt>y</alt></inlineequation> строки в качестве абсциссы.</para>
    <para>Дрейф определяется в два этапа: <orderedlist><listitem> Оценивается взаимное горизонтальное смещение для каждой пары строк не дальше, чем <guilabel>диапазон поиска</guilabel>. Оно оценивается как значение смещения, которое даёт максимальную взаимную корреляцию двух строк. Таким образом получается набор локальных оценок дрейфа строк (вместе с максимальными коэффициентами корреляции, которые обеспечивают оценку их действительного подобия). </listitem><listitem> Глобальные смещения рассчитываются из локальных. В настоящее время используется весьма простой метод, который работает в большинстве случаев: производные локального дрейфа аппроксимируются для каждой строки на оценку локального дрейфа и глобальный дрейф получается затем путём интеграции (т.е. суммирования локальных дрейфов). </listitem></orderedlist></para>
    <para>Опция <guilabel>Исключить линейный уклон</guilabel> вычитает линейный член из рассчитанного дрейфа. это может быть полезно, когда изображение является анизотропным и его выраженные детали считаются ориентированными непараллельно сторонам изображения. </para>
    <informalfigure id="fig-drift-correction">
      <mediaobject>
        <imageobject>
          <imagedata fileref="drift-corrected-graph.png" format="PNG"/>
        </imageobject>
        <caption>Пример коррекции дрейфа: (a) исходные данные с сильным дрейфом в оси быстрого сканирования, (b) исправленные данные, (c) рассчитанный график дрейфа.</caption>
      </mediaobject>
    </informalfigure>
  </sect2>
  <sect2 id="fft-filter-1d">
    <title>Одномерная фильтрация БПФ</title>
    <indexterm>
      <primary>Преобразование Фурье</primary>
      <secondary>одномерная фильтрация</secondary>
    </indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Одномерная фильтрация БПФ</guimenuitem>
      </menuchoice>
    </para>
    <para>Одним из наиболее удачных способов удаления шума на определённых частотах из изображения является Фурье-фильтрация. Сначала вычисляется прямое преобразование Фурье изображения. Затем к результату преобразования применяется фильтр. После этого обратное преобразование используется для получения отфильтрованного изображения. Gwyddion использует быстрое преобразование Фурье (БПФ или FFT) для существенного ускорения этого большого расчёта.</para>
    <para>При использовании одномерного фильтра БПФ частоты, которые должны быть удалены со спектра (тип подавления: убрать) или подавлены до значения соседних частот (тип подавления: выровнять), могут быть выбраны отметкой нужных областей на графике спектра мощности. Выбранная область может быть легко инвертирована используя тип фильтра. Одномерная фильтрация БПФ может использоваться как для горизонтального, так и для вертикального направления.</para>
  </sect2>
  <sect2 id="fft-filter-2d">
    <title>Двумерная фильтрация БПФ</title>
    <indexterm>
      <primary>Преобразование Фурье</primary>
      <secondary>двумерная фильтрация</secondary>
    </indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>двумерная фильтрация БПФ</guimenuitem>
      </menuchoice>
    </para>
    <para>Двумерная фильтрация БПФ работает подобно одномерному варианту (см. выше), но использует двумерное преобразование Фурье. Следовательно, пространственные частоты, которые нужно отфильтровать должны быть выбраны в двумерном пространстве с использованием редактора маски. Поскольку частоты измеряются относительно центра изображения (который соответствует нулевой частоте), маску можно прикрепить к центру (началу координат) в процессе редактирования. Также доступны различные режимы отображения и вывода результата, которые не требуют разъяснений – модуль может выводить изображение или коэффициенты БПФ (или оба).</para>
    <para>Следует заметить, что фильтр обычно передискретизирует данные до размера, который подходит для имеющегося алгоритма БПФ (FFTW или  Gwyddion FFT). Поскольку это может влиять на результат, размер передискретизированного изображения указан в окне модуля.</para>
  </sect2>
  <sect2 id="polynomial-distort">
    <title>Полиномиальное искривление</title>
    <indexterm><primary>искривление в плоскости xy</primary></indexterm>
    <para>
      <menuchoice>
        <guimenu>Обработка данных</guimenu>
        <guisubmenu>Исправить данные</guisubmenu>
        <guimenuitem>Полиномиальное искривление</guimenuitem>
      </menuchoice>
    </para>
    <para>Общее искривление в горизонтальной плоскости может быть компенсировано или, наоборот, внесено с помощью полиномиального искривления. Оно производит преобразования, которые могут быть выражены как</para>
    <informalequation id="eq-polynomial-distortion.en">
      <mediaobject>
        <imageobject>
          <imagedata fileref="eq-polynomial-distortion.en.png" format="PNG"/>
        </imageobject>
        <textobject role="tex">
          <phrase>
<![CDATA[
\eqnarray{
x_{\rm old}&=&P_x(x_{\rm new}, y_{\rm new}),\cr
y_{\rm old}&=&P_y(x_{\rm new}, y_{\rm new}),\cr
}
]]>
          </phrase>
        </textobject>
      </mediaobject>
    </informalequation>
    <para>где <inlineequation><mathphrase><phrase role="mathvar">P<subscript>x</subscript></phrase></mathphrase><alt>P_x</alt></inlineequation> и <inlineequation><mathphrase><phrase role="mathvar">P<subscript>y</subscript></phrase></mathphrase><alt>P_y</alt></inlineequation> – полиномы степени до третьей с заданными пользователем коэффициентами. Следует отметить направление преобразования координат – обратное направление не будет гарантировать однозначного отображения.</para>
    <para>Полиномиальные коэффициенты вводятся как независящие от масштаба, т.е. как если бы диапазоны координат всегда [0, 1]. Если включено <guilabel>Обновлять сразу</guilabel>, нажатие <keysym>Enter</keysym> в поле ввода коэффициента (или просто перемещение фокуса клавиатуры в другое место) обновляет предпросмотр.</para>
  </sect2>
</sect1>
<!-- vim: set ts=2 sw=2 et : -->
