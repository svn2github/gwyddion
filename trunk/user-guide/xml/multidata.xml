<?xml version='1.0' encoding='utf-8'?>
<!-- @(#) $Id$ -->
<!DOCTYPE book PUBLIC '-//OASIS//DTD DocBook XML V4.2//EN'
               'http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd'>
<section id="features-multidata">
  <title>Multiple Data</title>
  <para>
    To be written.
  </para>
  <section id="data-arithmetic">
    <title>Arithmetic</title>
    <para>
      <menuchoice>
        <guimenu>Data Process</guimenu>
        <guisubmenu>Multidata</guisubmenu>
        <guimenuitem>Arithmetic</guimenuitem>
      </menuchoice>
    </para>
    <para>
      Data Arithmetic module makes possible to perform arbitrary point-wise
      operations on a single data field or corresponding points of several
      data fields (currently up to five).  And although it is not its primary
      function it can be also used as a calculator with immediate expression
      evaluation.  The expression syntax is described in section
      <link linkend="expression-syntax">Expressions</link>.
    </para>
    <para>
      The data fields to operate on are called <guilabel>Operands</guilabel>
      and they are denoted <guilabel>d1</guilabel>, …, <guilabel>d5</guilabel>.
      The data fields that actually appear in the expression have to be
      compatible, i.e. their dimensions (both pixel and physical) have to be
      identical.  Other data fields (i.e. those not actually entering the
      expression) are irrelevant.  The result is always put into a newly
      created data field.
    </para>
    <para>
      Examples:
      <informalexample>
        <userinput>-d1</userinput>
      </informalexample>
      performs value inversion – very similar to Invert Value, except that
      Invert Value reflects about the mean value while now we simply change
      all values to negative,
      <informalexample>
        <userinput>(d1 - d2)^2</userinput>
      </informalexample>
      calculates squared difference between two data fields.
    </para>
    <para>
      In the calculator mode the expression is immediately evaluated as it is
      typed and the result is displayed below Expression entry.  No special
      action is necessary to switch between data field expressions and
      calculator: expressions containing only numeric quantities are
      immediately evaluated, expressions referring to data fields are used to
      calculate a new data field.
    </para>
  </section>
  <section>
    <title>Detail Immersion</title>
    <para>
      <menuchoice>
        <guimenu>Data Process</guimenu>
        <guisubmenu>Multidata</guisubmenu>
        <guimenuitem>Immerse</guimenuitem>
      </menuchoice>
    </para>
    <para>
      Immerse insets a detail, high-resolution image into a larger image.
    </para>
    <para>
      The detail can positioned manually on the large image with mouse.
      Button <guibutton>Improve</guibutton> can then be used to find the
      exact coordinates in the neighbourhood of the current position that give
      the maximum correlation between the detail and the large image.
      Or the best-match position can be searched through the whole image
      with <guibutton>Locate</guibutton>.
    </para>
    <para>
      It should be noted the correlation search is insensitive to value scales
      and offsets, therefore the automated matching is based solely on
      data features, absolute heights play no role.
    </para>
    <para>
      <guilabel>Result Sampling</guilabel> controls the size and resolution
      of the result image:
    </para>
    <variablelist>
      <varlistentry>
        <term>
          <guilabel>Upsample large image</guilabel>
        </term>
        <listitem>
          The resolution of the result is determined by the resolution of
          the inset detail.  Therefore the large image is scaled up.
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <guilabel>Downsample detail</guilabel>
        </term>
        <listitem>
          The resolution of the result is determined by the resolution of
          the large image.  The detail is downsampled.
        </listitem>
      </varlistentry>
    </variablelist>
    <para>
      <guilabel>Detail Leveling</guilabel> selects the transform of the
      <phrase role="math">z</phrase> values of the detail:
    </para>
    <variablelist>
      <varlistentry>
        <term>
          <guilabel>None</guilabel>
        </term>
        <listitem>
          No <phrase role="math">z</phrase> value adjustment is performed.
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>
          <guilabel>Mean value</guilabel>
        </term>
        <listitem>
          All values of the detail image are shifted by a constant to make
          its mean value match the mean value of the corresponding area of
          the large image.
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section>
    <title>Merging</title>
  </section>
  <section>
    <title>Cross-Correlation</title>
  </section>
  <section>
    <title>Mask by Correlation</title>
  </section>
</section>

