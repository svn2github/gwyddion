GSED = @GSED@
SHELL = @SHELL@

TEXS := $(wildcard eq-*.tex)
PNGS := $(subst .tex,.png,$(FORMULAS))
TEMPLATES = header.tex footer.tex defs.tex

T = TEMP-

all: png-images

Makefile: Makefile.in ../config.status
	cd .. && ./config.status formulas/Makefile

pngsize: pngsize.c
	$(CC) -o pngsize pngsize.c

png-images: $(PNGS)

%.png: %.tex $(TEMPLATES) pngsize render.sh
	$(SHELL) render.sh "$*"

clean:
	-rm -f eq-*.png eq-*.tex pngsize $(T)* *~

dist:
	mkdir ../$(DISTNAME)/formulas
	cp Makefile.in pngsize.c render.sh.in $(TEMPLATES) ../$(DISTNAME)/formulas

distclean: clean
	-rm -f Makefile render.sh

.PHONY: clean dist png-images all distclean
