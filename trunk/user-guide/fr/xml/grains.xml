<?xml version='1.0' encoding='utf-8'?>
<!-- @(#) $Id: grains.xml 12154 2011-03-01 15:46:58Z yeti-dn $ -->
<!DOCTYPE book PUBLIC '-//OASIS//DTD DocBook XML V4.5//EN'
               'http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd'>
<sect1 id='grain-analysis' xmlns:xi='http://www.w3.org/2001/XInclude'>
  <title>Analyse des grains</title>
  <indexterm><primary>marquage des grains</primary></indexterm>
  <para>
    Plusieurs algorithmes relatifs aux grains sont implémentés dans Gwyddion.
    On peut tout d'abord utiliser des algorithmes de seuillage (par hauteur,
    pente ou courbure). Ceux-ci sont très efficaces pour l'analyse de particules
    (pour marquer les particules présentes sur une surface plane).
  </para>
  <para id='grain-threshold'>
    <indexterm>
	  <primary>marquage de grain</primary>
	  <secondary>seuil</secondary>
	</indexterm>
    Les méthodes de seuillage sont accessibles dans le menu
    <menuchoice>
      <guimenu>Traitement des données</guimenu>
      <guisubmenu>Grains</guisubmenu>
      <guimenuitem>Marquer par seuil</guimenuitem>
    </menuchoice>.
    Les seuillage par hauteur, pente et courbure sont implémentés dans ce
    module. Les résultats de chacune de ces méthodes de seuillage peuvent être
    fusionnés à l'aide de plusieurs opérateurs.
  </para>
  <para id='grain-threshold-otsu'>
    <indexterm>
      <primary>marquage de grain</primary>
      <secondary>seuil</secondary>
      <tertiary>méthode d'Otsu</tertiary>
    </indexterm>
    La méthode de marquage d'Otsu est accessible dans 
    <menuchoice>
      <guimenu>Traitements des données</guimenu>
      <guisubmenu>Grains</guisubmenu>
      <guimenuitem>Marquer par la méthode d'Otsu</guimenuitem>
    </menuchoice>.
    Cette méthode sépare les valeurs en deux classes, en minimisant l'écart de
    variance propre à chaque classe. Elle est particulièrement adaptée aux 
    images contenant deux niveaux de valeurs relativement bien définis..
  </para>
  <para id='grain-edge'>
    <indexterm>
      <primary>marquage de grain</primary>
      <secondary>détection de bord</secondary>
    </indexterm>
    Une autre fonctio de marquage,
    <menuchoice>
      <guimenu>Traitement des données</guimenu>
      <guisubmenu>Grains</guisubmenu>
      <guimenuitem>Marquer par détection de bord</guimenuitem>
    </menuchoice>,
    est basée sur la détection de bord (courbure locale). L'image est traitée à
    l'aide d'un filtre de différence de gaussiennes d'une taille donnée, puis le
    seuillage est effectué sur l'image filtrée plutôt que sur l'originale.
  </para>
  <para id='grain-remove-touching-edges'>
    Les grains en contact avec l'un des bords de l'image peuvent être supprimés 
    du masque à l'aide du menu
    <menuchoice>
      <guimenu>Traitement des données</guimenu>
      <guisubmenu>Grains</guisubmenu>
      <guimenuitem>Supprimer les grains en contact avec les bords</guimenuitem>
    </menuchoice>.
    Cette fonction est utile si de tels grains sont considérés comme incomplets
    et doivent être exclus de l'analyse. Plusieurs autres fonctions de l'outil
    d'<link linkend='mask-editor'>édition de masque</link> peuvent être utiles
    pour modifier la forme des grains après le marquage.
  </para>
  <sect2 id='grain-watershed'>
    <title>
      Ligne de partage des eaux
      <guiicon>
        <inlinemediaobject>
          <imageobject>
            <imagedata fileref='gwy_grains_water-24.png' format='PNG'/>
          </imageobject>
        </inlinemediaobject>
      </guiicon>
    </title>
    <indexterm>
	  <primary>marquage de grain</primary>
	  <secondary>ligne de partage des eaux</secondary>
	</indexterm>
    <para>
      Dans le cas de structures plus complexes, les algorithmes de seuillage vus
      précédemment peuvent être inefficaces. Dans ce cas l'algorithme de
      segmentation par <emphasis>ligne des partage des eaux</emphasis> peut être 
      utilisé de manière beaucoup plus efficace pour le marquage de grains ou de 
      particules.
    </para>
    <para>
      L'algorithme de segmentation est généralement utilisé pour la détection de
      minima locaux et pour la segmentation d'image en traitement d'image.
      Comme le problème de la détermination de la position des grains peut être
      considéré comme un problème de détection d'extrema locaux, cet algorithme
      peut être utilisé pour des besoins de segmentation ou de marquage de
      grains. Par souci de simplicité nous traiterons des données inversées
      selon la direction <xi:include href="eqi-z.xml"/> pour la description de
      l'algorithme (c'est-à-dire que le sommet des grains sont des des minima 
      locaux dans le texte qui suit). Deux niveaux de traitement sont appliqués 
      pour l'analyse de grain (voir 
      [<link linkend='grain-analysis-ref-1'>1</link>]) :
    </para>
    <orderedlist>
      <listitem>
        Phase de localisation des grains : une goutte virtuelle est déposée en
        chaque point de la surface inversée (la quantité d'eau est contrôlée par
        le paramètre <guilabel>Taille de goutte</guilabel>).
        Dans le cas où la goutte ne se trouve pas déjà sur un minimum local,
        celle-ci suit la pente la plus forte afin de minimiser son énergie
        potentielle. La goutte s'arrête dès qu'elle atteind un minimum local.
        Elle remplit ainsi partiellement le minimum local en fonction de son
        volume (voir la figure et sa légende ci-dessous). Ce procédé est répété
        plusieurs fois (avec le paramètre <guilabel>Nombre de pas</guilabel>).
        Il en résulte un ensemble de lacs de différentes tailles
        remplissant la surface inversée. Les surfaces des lacs sont ensuite
        évaluées, et les plus petits d'entre eux sont supprimés, en prenant pour
        hypothèse que ceux-ci se sont formés dans les minima locaux provoqués
        par le bruit (tous les lacs plus petits que le paramètre
        <guilabel>Seuil</guilabel> sont supprimées). Les lacs les plus
        importants sont utilisés pour identifier
        la position des grains pour la segmentation lors de l'étape suivante.
        On élimine ainsi le bruit de mesure présent dans les données AFM.
      </listitem>
      <listitem>
        Phase de segmentataion : les grains trouvés lors de la première étape
        sont marqués (chacun avec un numéro différent). Les gouttes continuent
        de tomber vers la surface et de remplir les minima locaux (la quantité
        d'eau est contrôlée par le paramètre <guilabel>Taille de goutte</guilabel>).
        Le nombre total d'étapes d'aspersion de gouttes en chaque point de la
        surface est contrôlé par le paramètre <guilabel>Nombre d'étapes</guilabel>.
        Comme les grains ont déjà été marqués et identifiés lors de la première 
        étape, les situations suivantes peuvent apparaître dès qu'une goutte 
        atteind un minimum local :
        <orderedlist>
          <listitem>
            La goutte atteind un endroit déjà marqué comme étant un grain. Dans
            ce cas la goutte est fusionnée avec le grain, c'est-à-dire qu'elle est marquée
            comme faisant partie du même grain.
          </listitem>
          <listitem>
            La goutte atteind un endroit non marqué, mais un grain se trouve à
            proximité immédiate. Dans ce cas la goutte est là aussi fusionnée
            avec le grain.
          </listitem>
          <listitem>
            La goutte atteind un endroit non marqué et n'ayant aucun grain à
            proximité immédiate. Dans ce cas la goutte n'est pas marquée.
          </listitem>
          <listitem>
            La goutte atteind un endroit non marqué mais ayant plus d'un grain
            à proximité immédiate (par exemple lorsque deux grains se trouvent
            à proximité). Dans ce cas la goutte est marquée comme limite du
            grain.
          </listitem>
          <listitem>
            La goutte atteind un endroit marqué comme limite de grain. Dans ce
            cas la goutte est là aussi marquée comme limite de grain.
          </listitem>
        </orderedlist>
      </listitem>
    </orderedlist>
    <para>
      On peut ainsi identifier la position des grains et déterminer ensuite le
      volume occupé par chaque grain. On peut utiliser le paramètre
      <guilabel>Inverser les hauteurs</guilabel> dans le cas où les zones
      d'intérêt sont des vallées plutôt que des collines (grains)
    </para>
    <informalfigure id='fig-grain-marking'>
      <mediaobject>
        <imageobject>
          <imagedata fileref='allgrains.png' format='PNG'/>
        </imageobject>
        <caption>
          Image d'une surface à structure granuleuse (a) et résultats
          correspondant au seuillage par hauteur (b), au seuillage par courbure
          (c), et à l'algorithme de segmentation (d). Grâce à l'algorithme de
          segmentation, il est même possible de segmenter encore plus finement
          l'image.
        </caption>
      </mediaobject>
    </informalfigure>
  </sect2>
  <sect2 id='grain-analysis-statistics'>
    <title>Statistiques</title>
    <indexterm><primary>nombre de grains</primary></indexterm>
    <para>
      Les propriétés des grains peuvent être analysées à l'aide de plusieurs
      fonctions. La plus simple d'entre elles est la Statistique des Grains
    </para>
    <sect3 id='grain-statistics'>
      <title>Statistiques des grains</title>
      <para>
        <menuchoice>
          <guimenu>Traitement des données</guimenu>
          <guisubmenu>Grains</guisubmenu>
          <guimenuitem>Statistiques</guimenuitem>
        </menuchoice>
      </para>
      <para>
        Cette fonction calcule le nombre de grains marqués, leur aire projetée,
        à la fois en valeur absolue et en fraction de l'aire totale du champ de
        données, le total des volumes des grains, la longueur totale des
        périmètres des grains, l'aire moyenne ainsi que la taille du carré
        équivalent des grains. La taille moyenne est calculée en moyennant
        la taille des carrés équivalents, donc le carré de cette moyenne n'est
        en général pas égal à l'aire moyenne.
      </para>
      <para>
        Les caractéristiques globales de la zone marquée sont disponibles dans
        l'outil Statistiques en utilisant l'option <guilabel>Inclure
        uniquement la région masquée</guilabel>. On obtient les mêmes
        informations pour les zones non marquées en inversant le masque.
      </para>
    </sect3>
    <sect3 id='grain-distributions'>
      <title>
        Distributions des grains
        <guiicon>
          <inlinemediaobject>
            <imageobject>
              <imagedata fileref='gwy_grains_graph-24.png' format='PNG'/>
            </imageobject>
          </inlinemediaobject>
        </guiicon>
      </title>
      <para>
        <menuchoice>
          <guimenu>Traitement des données</guimenu>
          <guisubmenu>Grains</guisubmenu>
          <guimenuitem>Distributions</guimenuitem>
        </menuchoice>
      </para>
      <para>
        L'outil de calcul des distributions des grains est le plus puissant et
        le plus complexe. Il comporte deux modes d'opération : l'affichage de
        graphiques et l'export de données. Dans le mode affichage de graphiques,
        les caractéristiques sélectionnées sont calculées et rassemblées dans
        des graphes donnant leurs distributions.
      </para>
      <para>
        L'export de données est utile pour les experts ayant besoin par exemple
        de corréler les propriétés des grains. Dans ce mode les caractéristiques
        sélectionnées sont calculées et compilées dans un fichier texte sous la
        forme d'un tableau où chaque ligne correspond à un grain et chaque
        colonne à une caractéristique. L'ordre des colonnes est identique à
        celui des quantités présentées dans la fenêtre de dialogue ; toutes les
        valeurs sont données en unités SI, comme partout dans
        <application>Gwyddion</application>.
      </para>
    </sect3>
    <sect3 id='grain-correlation'>
      <title>
        Corrélation des caractéristiques des grains
      </title>
      <para>
        <menuchoice>
          <guimenu>Traitement des données</guimenu>
          <guisubmenu>Grains</guisubmenu>
          <guimenuitem>Corrélation</guimenuitem>
        </menuchoice>
      </para>
      <para>
        Affiche un graphe de corrélation d'une caractéristique en fonction d'une
        autre, permettant ainsi de visualiser les corrélations entre celles-ci.
      </para>
    </sect3>
    <sect3 id='grain-measure'>
      <title>
        Outil de mesure des grains
        <guiicon>
          <inlinemediaobject>
            <imageobject>
              <imagedata fileref='gwy_grains_measure-24.png' format='PNG'/>
            </imageobject>
          </inlinemediaobject>
        </guiicon>
      </title>
      <para>
        L'outil de mesure des grains est une manière interactive de déterminer
        les mêmes caractéristiques que celles données par
        <link linkend='grain-distributions'>distribution des grains</link> en
        mode texte. Il suffit de cliquer sur un grain dans la fenêtre de
        données pour que toutes les quantités soient affichées dans la
        fenêtre de l'outil.
      </para>
      <para>
        Cet outil affiche aussi le numéro du grain. Le numéro du grain
        correspond au numéro de ligne (en partant de 1) des fichiers exportés
        par le calcul des
        <link linkend='grain-distributions'>distributions des grains</link>.
      </para>
    </sect3>
  </sect2>
  <sect2 id='grain-properties'>
    <title>Caractéristiques des grains</title>
    <para>
      Les <link linkend='grain-distributions'>distribution des grains</link> et
      <link linkend='grain-measure'>l'outil de mesure des grains</link> peuvent
      alculer les caractéristiques suivantes :
    </para>
    <variablelist>
      <varlistentry>
        <term>Caractéristiques liées à la valeur</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <indexterm>
                <primary>minimum</primary>
                <secondary>d'un grain</secondary>
              </indexterm>
              <guilabel>Minimum</guilabel>,
              valeur (hauteur) minimale présente dans le grain.
            </listitem>
            <listitem>
              <indexterm>
                <primary>maximum</primary>
                <secondary>d'un grain</secondary>
              </indexterm>
              <guilabel>Maximum</guilabel>,
              valeur (hauteur) maximale présente dans le grain.
            </listitem>
            <listitem>
              <indexterm>
                <primary>moyenne</primary>
                <secondary>d'un grain</secondary>
              </indexterm>
              <guilabel>Moyenne</guilabel>,
              moyenne des valeurs présentes dans le grain, c'est-à-dire la
              hauteur moyenne du grain.
            </listitem>
            <listitem>
              <indexterm>
                <primary>médiane</primary>
                <secondary>d'un grain</secondary>
              </indexterm>
              <guilabel>Médiane</guilabel>
              médiane des valeurs présentes dans le grain, c'est-à-dire la
              hauteur médiane du grain.
            </listitem>
            <listitem>
              <indexterm>
                <primary>minimum</primary>
                <secondary>du bord d'un grain</secondary>
              </indexterm>
              <guilabel>Minimum du bord</guilabel>,
              valeur (hauteur) minimale présente sur le bord interne d'un grain.
              Le bord est représenté par les pixels présents dans le grain et
              ayant au moins un pixel voisin en dehors du grain.
            </listitem>
            <listitem>
              <indexterm>
                <primary>maximum</primary>
                <secondary>du bord d'un grain</secondary>
              </indexterm>
              <guilabel>Maximum du bord</guilabel>,
              valeur (hauteur) maximale présente sur le bord interne d'un grain,
              défini de la même manière que pour le minimum.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées à la surface</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Surface projetée</guilabel>,
              aire projetée (c'est-à-dire plane) du grain.
            </listitem>
            <listitem>
              <guilabel>Côté équivalent</guilabel>,
              taille du carré ayant la même surface que la surface projetée du
              grain.
            </listitem>
            <listitem>
              <guilabel>Rayon équivalent</guilabel>,
              rayon du disque ayant la même surface que la surface projetée du
              grain.
            </listitem>
            <listitem>
              <guilabel>Surface</guilabel>,
              surface du grain, reportez-vous à la section
              <link linkend='surface-area-calculation'>quantités statistiques</link>
              pour une description de la méthode d'estimation de la surface.
            </listitem>
            <listitem>
              <guilabel>Aire de l'enveloppe convexe</guilabel>, aire projetée
              de l'enveloppe convexe du grain. Celle-ci est légèrement plus
              grande que la surface du grain, même pour les grains visiblement
              convexe, à cause de la pixellisation du masque. Seuls les grains
              parfaitement rectangulaires ont la même surface.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées au bord</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Périmètre projeté</guilabel>,
              longueur du bord du grain projeté sur le plan horizontal (et non
              sur la surface tri-dimensionnelle). La méthode d'estimation du
              périmètre est décrite plus bas.
            </listitem>
            <listitem>
              <guilabel>Largeur</guilabel>,
              dimension minimale du grain dans le plan horizontal. On peut voir
              celle-ci comme étant le plus petit écart au travers duquel
              passerait le grain.
            </listitem>
            <listitem>
              <guilabel>Orientation de la largeur</guilabel>,
              orientation de l'écart décrit précédemment. Si le grain présente
              une symétrie lui conférant plusieurs directions possibles,
              celle-ci est choisie arbitrairement.
            </listitem>
            <listitem>
              <guilabel>Longueur</guilabel>,
              dimension maximale du grain dans le plan horizontal.  On peut voir
              celle-ci comme étant le plus grand écart que le grain pourrait
              remplir
            </listitem>
            <listitem>
              <guilabel>Orientation de la longueur</guilabel>,
              orientation de l'écart décrit précédemment. Si le grain présente
              une symétrie lui conférant plusieurs directions possibles,
              celle-ci est choisie arbitrairement.
            </listitem>
            <listitem>
              <guilabel>Rayon maximal du disque inscrit</guilabel>, rayon du
              disque le plus grand pouvant s'inscrire dans le grain. Le disque
              entier doit s'incrire, pas seulement le cercle extérieur, ce qui
              a son importance dans le cas des grains présentant des vides.
              Vous pouvez utiliser
              <link linkend='tool-mask-editor'>l'éditeur de masque</link> pour
              remplir les vides présents dans les grains.
            </listitem>
            <listitem>
              <guilabel>Position x du centre du disque inscrit maximal</guilabel>,
              coordonnée horizontale du centre du disque inscrit maximal. Plus
              précisément, une des coordonnées si le disque n'est pas unique.
            </listitem>
            <listitem>
              <guilabel>Position y du centre du disque inscrit maximal</guilabel>,
              coordonnée verticale du centre du disque inscrit maximal. Plus
              précisément, une des coordonnées si le disque n'est pas unique,
              mais elle correspond au même disque que celui de la donnée
              précédente.
            </listitem>
            <listitem>
              <guilabel>Rayon minimal du disque circonscrit</guilabel>, rayon du
              plus petit cercle pouvant contenir le grain.
            </listitem>
            <listitem>
              <guilabel>Position x du centre du disque circonscrit</guilabel>,
              coordonnée horizontale du centre du cercle circonscrit.
            </listitem>
            <listitem>
              <guilabel>Position y du centre du disque circonscrit</guilabel>,
              coordonnée horizontale du centre du cercle circonscrit.
            </listitem>
            <listitem>
              <guilabel>Rayon moyen</guilabel>, distance moyenne entre le
              barycentre du grain et le bord de celui-ci. Cette quantité n'est
              en général utile que dans le cas des grains convexes ou
              quasi-convexes.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées au volume</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Base zéro</guilabel>,
              volume entre la surface du grain et le plan
              <xi:include href="eqi-z-is-0.xml"/>. Les valeurs en-dessous de
              zéro représentent un volume négatif. Le niveau zéro doit être
              défini à une valeur raisonnable (en général la fonction
              <link linkend='fix-zero'>fixer le zéro</link> suffit) pour que le
              résultat ait un sens, ce qui est aussi l'avantage de cette
              méthode : on peut utiliser le plan de base que l'on souhaite.
            </listitem>
            <listitem>
              <guilabel>Base minimum du grain</guilabel>,
              volume entre la surface du grain et le plan
              <xi:include href="eqi-z-is-z_min.xml"/>, où
              <xi:include href="eqi-z_min.xml"/> est la valeur (hauteur)
              minimale présente dans le grain. Cette méthode tient compte de
              l'environnement du grain, mais typiquement elle sous-estime le
              volume, en particulier pour les petits grains.
            </listitem>
            <listitem>
              <guilabel>Base arrière-plan laplacien</guilabel>,
              volume entre la surface du grain et la surface de base formée
              par l'interpolation laplacienne des valeurs environnantes. Plus
              précisément, il s'agit du volume qui disparaîtrait après avoir
              appliquéla fonction
              <link linkend='remove-data-under-mask'>supprimer les données sous le masque</link>
              ou l'outil
              <link linkend='tool-remove-grains'>suppression de grain</link>
              avec l'interpolation laplacienne. Il s'agit de la méthode la plus
              sophistiquée, mais aussi la moins intuitive.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées à la position</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Position centrale x</guilabel>,
              coordonnée horizontale du centre du grain. Comme la surface du
              grain est définie par la surface couverte par les pixels du
              masque, le centre d'un grain ne faisant qu'un seul pixel sera un
              demi-entier et non un entier. Le décalage de l'origine du champ de
              données est pris en compte.
            </listitem>
            <listitem>
              <guilabel>Position centrale y</guilabel>,
              coordonnée horizontale du centre du grain. Voir l'interprétation
              plus haut.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées à la pente</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Inclinaison θ</guilabel>,
              déviation de la normale du plan moyen par rapport à l'axe
              <xi:include href="eqi-z.xml"/>, reportez-vous au paragraphe
              <link linkend='inclinations-coordinates'>inclinaisons</link>
              pour plus de détails.
            </listitem>
            <listitem>
              <guilabel>Inclinaison φ</guilabel>,
              azimuth de la pente, telle que définie dans le paragraphe
              <link linkend='inclinations-coordinates'>inclinaisons</link>.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées à la courbure</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Position <xi:include href="eqi-x.xml"/> du centre de courbure</guilabel>,
              position horizontale du centre de la surface quadratique ajustée à
              la surface du grain.
            </listitem>
            <listitem>
              <guilabel>Position <xi:include href="eqi-y.xml"/> du centre de courbure</guilabel>,
              position verticale du centre de la surface quadratique ajustée à
              la surface du grain.
            </listitem>
            <listitem>
              <guilabel>Valeur <xi:include href="eqi-z.xml"/> du centre de courbure</guilabel>,
              valeur au centre de la surface quadratique ajustée à
              la surface du grain. Notez qu'il s'agit de la valeur sur la
              surface ajustée et non sur la surface réelle.
            </listitem>
            <listitem>
              <guilabel>Courbure 1</guilabel>,
              la plus petite courbure (c'est-à-dire l'inverse du rayon de courbure) au
              centre.
            </listitem>
            <listitem>
              <guilabel>Courbure 2</guilabel>,
              la plus grande courbure (c'est-à-dire l'inverse du rayon de courbure) au
              centre.
            </listitem>
            <listitem>
              <guilabel>Angle de courbure 1</guilabel>,
              direction correspondant à <guilabel>Courbure 1</guilabel>.
            </listitem>
            <listitem>
              <guilabel>Angle de courbure 2</guilabel>,
              direction correspondant à <guilabel>Courbure 2</guilabel>.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Caractéristiques liées au moment</term>
        <listitem>
          <itemizedlist>
            <listitem>
              <guilabel>Demi-grand axe de l'ellipse équivalente</guilabel>,
              longueur du demi-grand axe de l'ellipse ayant les mêmes moments
              d'ordre deux dans le plan horizontal.
            </listitem>
          </itemizedlist>
          <itemizedlist>
            <listitem>
              <guilabel>Demi-petit axe de l'ellipse équivalente</guilabel>,
              longueur du demi-petit axe de l'ellipse ayant les mêmes moments
              d'ordre deux dans le plan horizontal.
            </listitem>
          </itemizedlist>
          <itemizedlist>
            <listitem>
              <guilabel>Orientation de l'ellipse équivalente</guilabel>,
              direction du demi-grand axe de l'ellipse ayant les mêmes moments
              d'ordre deux dans le plan horizontal. L'angle vaut par définition
              zéro pour un grain circulaire.
            </listitem>
          </itemizedlist>
        </listitem>
      </varlistentry>
    </variablelist>
    <informalfigure id='fig-grain-bounding-dims'>
      <mediaobject>
        <imageobject>
          <imagedata fileref='grain-bounding-dims.pdf' format='PDF'/>
        </imageobject>
        <imageobject>
          <imagedata fileref='grain-bounding-dims.png' format='PNG'/>
        </imageobject>
        <caption>
          Dimensions minimale et maximale, et orientations correspondantes d'un grain.
        </caption>
      </mediaobject>
    </informalfigure>
    <para id='boundary-length-calculation'>
      <indexterm><primary>calcul du périmètre</primary></indexterm>
      Le périmètre des grains est estimé en sommant des contributions estimées
      de chacune des configurations à quatre pixels sur le bord du grain. Les
      contributions sont affichées sur la figure suivante pour chaque
      configuration, où <xi:include href="eqi-h_x.xml"/> et
      <xi:include href="eqi-h_y.xml"/> sont les dimensions du pixel selon les
      axes correspondants, et <xi:include href="eqi-h.xml"/> est la longueur de
      la diagonale du pixel :
      <xi:include href="eq-grain-boundary-pixel-diagonal.xml"/>
      Les contributions correspondent une à une aux longueurs des segments du
      bord du polygone approximant la forme du grain. La construction du
      polygone équivalent est aussi visible sur la figure.
    </para>
    <informalfigure id='fig-boundary-length'>
      <mediaobject>
        <imageobject>
          <imagedata fileref='boundary-length.pdf' format='PDF'/>
        </imageobject>
        <imageobject>
          <imagedata fileref='boundary-length.png' format='PNG'/>
        </imageobject>
        <caption>
          Contributions des configurations de pixels sur la longueur estimée du
          bord (en haut). Les carrés en gris représentent les pixels à
          l'intérieur du grain, et les carrés en blanc ceux à l'extérieur. La
          contribution estimée de chaque configuration est :
          (a) <xi:include href="eqi-h-over-2.xml"/>,
          (b1), (b2) <xi:include href="eqi-h.xml"/>,
          (c) <xi:include href="eqi-h_y.xml"/>,
          (d) <xi:include href="eqi-h_x.xml"/>,
          (e) <xi:include href="eqi-h-over-2.xml"/>.
          Les cas (b1) et (b2) ne diffèrent que dans la visualisation de la
          forme des segments du polygone, les longueurs estimées du bord sont
          identiques. La partie inférieure de la figure illustre la manière dont
          les segments se joignent pour former le polygone.
        </caption>
      </mediaobject>
    </informalfigure>
    <para id='grain-volume-calculation'>
      <indexterm><primary>calcul du volume</primary></indexterm>
      Le volume est, après soustraction de la base, estimée comme étant le
      volume de l'objet dont la surface supérieure est celle utilisée pour le
      <link linkend='fig-surface-area-vertices'>calcul de surface</link>.
      Notez que pour le volume entre les vertex, ceci est équivalent à la
      méthode classique des trapèzes pour l'intégration en deux dimensions.
      Cependant, nous calculons le volume sous un masque centré sur les vertex,
      leur contribution à l'intégrale est donc distribuée de manière différente,
      tel que montré dans la figure suivante.
    </para>
    <informalfigure id='fig-volume-pixel-weights'>
      <mediaobject>
        <imageobject>
          <imagedata fileref='volume-pixel-weights.pdf' format='PDF'/>
        </imageobject>
        <imageobject>
          <imagedata fileref='volume-pixel-weights.png' format='PNG'/>
        </imageobject>
        <caption>
          Contributions des pixels individuels au volume d'un pixel (en gris).
        </caption>
      </mediaobject>
    </informalfigure>
    <para>
      Les caractéristiques liées à la courbure des grains sont calculées de
      manière identique à la courbure globale donnée par la fonction
      <link linkend='curvature'>courbure</link>.  Référez-vous à sa description
      pour plus de détails.
    </para>
    <informalfigure id='fig-grain-inscribed-exscribed'>
      <mediaobject>
        <imageobject>
          <imagedata fileref='grain-inscribed-exscribed.pdf' format='PDF'/>
        </imageobject>
        <imageobject>
          <imagedata fileref='grain-inscribed-exscribed.png' format='PNG'/>
        </imageobject>
        <caption>
          Disque inscrit maximal et cercle circonscrit minimal d'un grain.
        </caption>
      </mediaobject>
    </informalfigure>
    <para>
      Les disques inscrits et les cercles circonscrits aux grains peuvent être
      visualisés en utilisant
      <menuchoice>
        <guimenu>Traitement des données</guimenu>
        <guisubmenu>Grains</guisubmenu>
        <guimenuitem>Sélectionner les disques inscrits</guimenuitem>
      </menuchoice>
      et
      <menuchoice>
        <guimenu>Traitement des données</guimenu>
        <guisubmenu>Grains</guisubmenu>
        <guimenuitem>Sélectionner les cercles circonscrits</guimenuitem>
      </menuchoice>.
      Ces fonctions créent des sélections circulaires représentant les disques
      et cercles correspondants pour chaque grain, celles-ci pouvant être
      affichées par la suite avec le
      <link linkend='tool-selection-manager'>gestionnaire de sélections</link>.
    </para>
  </sect2>
  <sect2 id='grain-filter'>
    <title>
      Filtrage des grains
      <guiicon>
        <inlinemediaobject>
          <imageobject>
            <imagedata fileref='gwy_grains_remove-24.png' format='PNG'/>
          </imageobject>
        </inlinemediaobject>
      </guiicon>
    </title>
    <para>
      Les grains marqués peuvent être filtrés par seuillage sur différentes
      quantités à l'aide de la fonction
      <menuchoice>
        <guimenu>Traitements des données</guimenu>
        <guisubmenu>Grains</guisubmenu>
        <guimenuitem>Filtrer</guimenuitem>
      </menuchoice>.
      Ce module peut être utilisé pour des opérations basiques, telle que la
      suppression de petits grains à l'aide d'un seuillage basé sur l'aire, ou
      des filtrages bien plus complexes à l'aide d'expressions logiques
      impliquant différentes quantités.
    </para>
    <para>
      Le filtre conserve les grains satisfaisant les conditions définies dans
      <guilabel>Conserver les grains satisfaisant</guilabel> et supprime tous 
      les autres. La condition est exprimée par l'association logique de une à 
      trois conditions, notées <varname>A</varname>, <varname>B</varname> et
      <varname>C</varname>. L'expression la plus simple est juste 
      <varname>A</varname>, qui impose que la quantité <varname>A</varname> 
      soit entre les seuils définis.
    </para>
    <para>
      Chaque condition consiste en deux seuils haut et bas pour une quantité
      donnée, par exemple l'aire ou la valeur minimale. Les valeurs doivent
      appartenir à l'intervalle [bas,haut] pour satisfaire la condition
      et conserver ainsi les grains. Notez qu'il est possible de choisir un 
      seuil bas plus élevé que le seuil haut. Dans ce cas la condition est
      inversée, c'est-à-dire que le grain est conservé si la valeur est en 
      dehors de l'intervalle [haut,bas].
    </para>
    <para>
      Les quantités sont assignées à <varname>A</varname>,
      <varname>B</varname> et <varname>C</varname> en sélectionnant la quantité
      dans la liste puis en cliquant sur le bouton correspondant dans 
      <guilabel>Assigner à</guilabel>. L'ensemble des quantités sélectionnées
      est affiché dans les en-têtes
      <guilabel>Condition A</guilabel>,
      <guilabel>Condition B</guilabel> et
      <guilabel>Condition C</guilabel>.
    </para>
  </sect2>
  <sect2 id='grain-level'>
    <title>Mise à niveau des grains</title>
    <indexterm><primary>mise à niveau des grains</primary></indexterm>
    <para>
      Les grains peuvent être alignés verticalement en utilisant
      <menuchoice>
        <guimenu>Traitement des données</guimenu>
        <guisubmenu>Grains</guisubmenu>
        <guimenuitem>Mise à niveau des grains</guimenuitem>
      </menuchoice>.
      Cette fonction décale verticalement chaque grain de façon à ce qu'une
      caractéristique liée à la hauteur soit égale pour tous les grains. En
      général, on aligne la valeur minimale des grains, mais d'autres choix sont
      possibles.
    </para>
    <para>
      Les données entre les grains sont aussi décalées verticalement. Les
      décalages sont interpolés par rapport aus décalages des grains à l'aide de
      l'équation de Laplace, ce qui donne une transition douce des décalages
      entre les grains (toutefois on ne considère pas les autres éléments
      présents sur la surface).
    </para>
  </sect2>
  <sect2 id='grain-edt'>
    <title>Carte de distances euclidiennes</title>
    <indexterm><primary>carte de distances</primary></indexterm>
    <para>
      La carte de distances euclidiennes donne pour chaque pixel sa distance
      par rapport au bord du grain (masque). Elle est, d'une certaine manière,
      complémentaire à la segmentation.
    </para>
    <para>
      Lorsqu'elle est appliquée à l'intérieur des grains, la distance vaut zéro
      en-dehors de ceux-ci, et augmente vers leurs «centres». À l'inverse, elle
      peut être appliquée à l'extérieur des grains, dans ce cas la valeur est 
      plus élevée pour les pixels les plus éloignés des grains. Il est aussi
      possible de calculer une carte signée pour les deux côtés, avec des 
      valeurs positives à l'intérieur des grains, et négatives à l'extérieur.
    </para>
    <para>
      L'option <guilabel>éroder à partir des bords</guilabel> contrôle le
      comportement du calcul sur les bords de l'image. Lorsqu'elle est activée,
      les bords de l'image sont considérés comme étant aussi les bords d'un 
      grain (si le bord est marqué). De cette manière, les bords de l'image ne 
      peuvent se voir attribuer une valeur élevée. En étant désactivée, les
      grains sont considérés comme s'étendant à l'infini en dehors de l'image.
      Les pixels en bord d'image peuvent dans ce cas avoir des valeurs élevées.
    </para>
  </sect2>
  <sect2 id='grain-analysis-ref'>
    <title>Références</title>
    <para id='grain-analysis-ref-1'>
      [1] <ulink url='http://klapetek.cz/download.html'>
        Petr Klapetek, Ivan Ohlídal, Daniel Franta, Alberto Montaigne-Ramil, Alberta Bonanni, David Stifter, Helmut Sitter:
        Acta Physica Slovaca, 3 (223-230), 2003
      </ulink>
    </para>
  </sect2>
  <!--  Doesn't work well, needs serious formatting improvements.
  <bibliography>
    <biblioentry>
      <biblioset relation='article'>
        <authorgroup>
          <author><firstname>Petr</firstname><surname>Klapetek</surname></author>
          <author><firstname>Ivan</firstname><surname>Ohlídal</surname></author>
          <author><firstname>Daniel</firstname><surname>Franta</surname></author>
          <author><firstname>Alberto</firstname><surname>Montaigne-Ramil</surname></author>
          <author><firstname>Alberta</firstname><surname>Bonanni</surname></author>
          <author><firstname>David</firstname><surname>Stifter</surname></author>
          <author><firstname>Helmut</firstname><surname>Stifter</surname></author>
        </authorgroup>
        <title>Atomic force microscopy characterization of ZnTe epitaxial films</title>
      </biblioset>
      <biblioset relation='journal'>
        <title>Acta Physica Slovaca</title>
        <volumenum>3</volumenum>
        <pagenums>223-230</pagenums>
        <pubdate>2003</pubdate>
      </biblioset>
    </biblioentry>
  </bibliography>
  -->
</sect1>
<!-- vim: set ts=2 sw=2 et : -->
